2025-07-15 18:57:50,932 - RouterTest - INFO - 🚀 开始启用/停用VLAN的API捕获测试（长时间等待版本）
2025-07-15 18:57:52,097 - RouterTest - INFO - ✅ 已设置全局API监听器
2025-07-15 18:57:52,099 - RouterTest - INFO - 开始登录，用户名: admin
2025-07-15 18:57:53,201 - RouterTest - INFO - 成功导航到页面: http://10.66.0.40/login#/login
2025-07-15 18:57:56,243 - RouterTest - INFO - 成功输入文本 role=textbox, name=用户名: admin
2025-07-15 18:57:57,266 - RouterTest - INFO - 成功输入文本 role=textbox, name=密码: admin123
2025-07-15 18:57:58,293 - RouterTest - INFO - 成功点击元素 role=button, name=登录
2025-07-15 18:58:03,796 - RouterTest - INFO - URL已跳转，登录可能成功
2025-07-15 18:58:03,797 - RouterTest - INFO - 登录成功: admin
2025-07-15 18:58:03,797 - RouterTest - INFO - ✅ 登录成功
2025-07-15 18:58:03,797 - RouterTest - INFO - 导航到VLAN设置页面
2025-07-15 18:58:06,858 - RouterTest - INFO - 成功点击文本元素: 网络设置
2025-07-15 18:58:08,478 - RouterTest - INFO - 🎯 [全局监听] 捕获到VLAN API: action=show
2025-07-15 18:58:08,479 - RouterTest - INFO - 🎯 [全局监听] 请求体: {"func_name":"vlan","action":"show","param":{"TYPE":"total,data","limit":"0,20","ORDER_BY":"","ORDER...
2025-07-15 18:58:08,484 - RouterTest - INFO - 🎯 [全局监听] 响应: {'Result': 30000, 'ErrMsg': 'Success', 'Data': {'total': 5, 'data': [{'mac': '00:53:3d:1f:e5:47', 'ip_addr': '192.168.36.1', 'netmask': '255.255.255.0', 'ip_mask': '', 'interface': 'lan1', 'id': 1, 'enabled': 'yes', 'comment': '基础VLAN测试', 'vlan_id': '36', 'vlan_name': 'vlan36', 'ip_addr_int': 3232244737}, {'mac': '00:e2:2b:04:be:69', 'ip_addr': '192.168.201.1', 'netmask': '255.255.255.0', 'ip_mask': '', 'interface': 'lan1', 'id': 2, 'enabled': 'yes', 'comment': '批量测试VLAN201', 'vlan_id': '201', 'vlan_name': 'vlan201', 'ip_addr_int': 3232286977}, {'mac': '00:41:0d:e7:5b:87', 'ip_addr': '192.168.202.1', 'netmask': '255.255.255.0', 'ip_mask': '', 'interface': 'lan1', 'id': 3, 'enabled': 'yes', 'comment': '批量测试VLAN202', 'vlan_id': '202', 'vlan_name': 'vlan202', 'ip_addr_int': 3232287233}, {'mac': '00:dd:f2:d0:14:a6', 'ip_addr': '192.168.203.1', 'netmask': '255.255.255.0', 'ip_mask': '', 'interface': 'lan1', 'id': 4, 'enabled': 'yes', 'comment': '批量测试VLAN203', 'vlan_id': '203', 'vlan_name': 'vlan203', 'ip_addr_int': 3232287489}, {'mac': '00:ca:8d:ef:41:33', 'ip_addr': '192.168.88.100', 'netmask': '255.255.255.128', 'ip_mask': '192.168.116.1/255.255.255.128', 'interface': 'lan1', 'id': 5, 'enabled': 'yes', 'comment': '编辑后的工作流程测试VLAN', 'vlan_id': '888', 'vlan_name': 'vlan888_edited', 'ip_addr_int': 3232258148}]}}
2025-07-15 18:58:09,396 - RouterTest - INFO - 成功点击链接: VLAN设置
2025-07-15 18:58:12,899 - RouterTest - INFO - 成功导航到VLAN设置页面
2025-07-15 18:58:12,899 - RouterTest - INFO - ✅ 成功进入VLAN页面
2025-07-15 18:58:12,899 - RouterTest - INFO - 导航到VLAN设置页面
2025-07-15 18:58:15,942 - RouterTest - INFO - 成功点击文本元素: 网络设置
2025-07-15 18:58:17,445 - RouterTest - INFO - 🎯 [全局监听] 捕获到VLAN API: action=down
2025-07-15 18:58:17,445 - RouterTest - INFO - 🎯 [全局监听] 请求体: {"func_name":"vlan","action":"down","param":{"id":"1,2,3,4,5"}}...
2025-07-15 18:58:17,449 - RouterTest - INFO - 🎯 [全局监听] 响应: {'Result': 30000, 'ErrMsg': 'Success'}
2025-07-15 18:58:17,550 - RouterTest - INFO - 🎯 [全局监听] 捕获到VLAN API: action=show
2025-07-15 18:58:17,550 - RouterTest - INFO - 🎯 [全局监听] 请求体: {"func_name":"vlan","action":"show","param":{"TYPE":"total,data","limit":"0,20","ORDER_BY":"","ORDER...
2025-07-15 18:58:17,553 - RouterTest - INFO - 🎯 [全局监听] 响应: {'Result': 30000, 'ErrMsg': 'Success', 'Data': {'total': 5, 'data': [{'mac': '00:53:3d:1f:e5:47', 'ip_addr': '192.168.36.1', 'netmask': '255.255.255.0', 'ip_mask': '', 'interface': 'lan1', 'id': 1, 'enabled': 'no', 'comment': '基础VLAN测试', 'vlan_id': '36', 'ip_addr_int': 3232244737, 'vlan_name': 'vlan36'}, {'mac': '00:e2:2b:04:be:69', 'ip_addr': '192.168.201.1', 'netmask': '255.255.255.0', 'ip_mask': '', 'interface': 'lan1', 'id': 2, 'enabled': 'no', 'comment': '批量测试VLAN201', 'vlan_id': '201', 'ip_addr_int': 3232286977, 'vlan_name': 'vlan201'}, {'mac': '00:41:0d:e7:5b:87', 'ip_addr': '192.168.202.1', 'netmask': '255.255.255.0', 'ip_mask': '', 'interface': 'lan1', 'id': 3, 'enabled': 'no', 'comment': '批量测试VLAN202', 'vlan_id': '202', 'ip_addr_int': 3232287233, 'vlan_name': 'vlan202'}, {'mac': '00:dd:f2:d0:14:a6', 'ip_addr': '192.168.203.1', 'netmask': '255.255.255.0', 'ip_mask': '', 'interface': 'lan1', 'id': 4, 'enabled': 'no', 'comment': '批量测试VLAN203', 'vlan_id': '203', 'ip_addr_int': 3232287489, 'vlan_name': 'vlan203'}, {'mac': '00:ca:8d:ef:41:33', 'ip_addr': '192.168.88.100', 'netmask': '255.255.255.128', 'ip_mask': '192.168.116.1/255.255.255.128', 'interface': 'lan1', 'id': 5, 'enabled': 'no', 'comment': '编辑后的工作流程测试VLAN', 'vlan_id': '888', 'ip_addr_int': 3232258148, 'vlan_name': 'vlan888_edited'}]}}
2025-07-15 18:58:18,512 - RouterTest - INFO - 成功点击链接: VLAN设置
2025-07-15 18:58:22,014 - RouterTest - INFO - 成功导航到VLAN设置页面
2025-07-15 18:58:24,016 - RouterTest - INFO - 🎯 [全局监听] 捕获到VLAN API: action=up
2025-07-15 18:58:24,016 - RouterTest - INFO - 🎯 [全局监听] 请求体: {"func_name":"vlan","action":"up","param":{"id":"1,2,3,4,5"}}...
2025-07-15 18:58:24,019 - RouterTest - INFO - 🎯 [全局监听] 响应: {'Result': 30000, 'ErrMsg': 'Success'}
2025-07-15 18:58:24,182 - RouterTest - INFO - 获取到VLAN列表，共 5 条记录
2025-07-15 18:58:24,182 - RouterTest - DEBUG - VLAN数据结构示例: {'id': '36', 'name': 'vlan36', 'mac': '00:53:3d:1f:e5:47', 'ip': '192.168.36.1', 'subnet_mask': '255.255.255.0', 'line': 'lan1', 'comment': '基础VLAN测试', 'status': '已启用'}
2025-07-15 18:58:24,182 - RouterTest - INFO - 📋 准备测试VLAN 36
2025-07-15 18:58:24,192 - RouterTest - INFO - 📊 当前VLAN 36 状态: 已启用
2025-07-15 18:58:24,192 - RouterTest - INFO - 🧹 清空API记录，开始新的测试
2025-07-15 18:58:24,193 - RouterTest - INFO - 🔄 当前是启用状态，开始测试停用操作...
2025-07-15 18:58:24,234 - RouterTest - INFO - 🎯 找到停用按钮，准备点击...
2025-07-15 18:58:24,269 - RouterTest - INFO - 🎯 [全局监听] 捕获到VLAN API: action=down
2025-07-15 18:58:24,269 - RouterTest - INFO - 🎯 [全局监听] 请求体: {"func_name":"vlan","action":"down","param":{"id":"1"}}...
2025-07-15 18:58:24,272 - RouterTest - INFO - 🎯 [全局监听] 响应: {'Result': 30000, 'ErrMsg': 'Success'}
2025-07-15 18:58:25,263 - RouterTest - INFO - ✅ 已点击停用按钮
2025-07-15 18:58:25,263 - RouterTest - INFO - ⏳ 等待30秒以捕获API调用...
2025-07-15 18:58:25,263 - RouterTest - INFO - 🎉 在第1次检查时检测到API调用！
2025-07-15 18:58:25,264 - RouterTest - INFO -   - Action: down
2025-07-15 18:58:25,264 - RouterTest - INFO - ⏳ 再等待10秒以确保所有延迟的API调用都被捕获...
2025-07-15 18:58:35,264 - RouterTest - INFO - 📊 最终捕获到 1 个API调用
2025-07-15 18:58:35,265 - RouterTest - INFO -   1. Action: down, URL: http://10.66.0.40/Action/call
2025-07-15 18:58:35,265 - RouterTest - INFO - 🔚 测试完成，浏览器将保持打开状态以观察...
2025-07-15 18:58:43,101 - RouterTest - INFO - 🎯 [全局监听] 捕获到VLAN API: action=down
2025-07-15 18:58:43,101 - RouterTest - INFO - 🎯 [全局监听] 请求体: {"func_name":"vlan","action":"down","param":{"id":"2"}}...
2025-07-15 18:58:43,104 - RouterTest - INFO - 🎯 [全局监听] 捕获到VLAN API: action=up
2025-07-15 18:58:43,104 - RouterTest - INFO - 🎯 [全局监听] 请求体: {"func_name":"vlan","action":"up","param":{"id":"1,2,3,4,5"}}...
2025-07-15 18:58:43,124 - RouterTest - ERROR - 处理请求时出错: Request.response: Target page, context or browser has been closed
2025-07-15 18:58:43,125 - RouterTest - ERROR - 处理请求时出错: Request.response: Target page, context or browser has been closed
